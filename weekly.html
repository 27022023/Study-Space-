<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffffff"> <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner</title>
    <style>
        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #c7d8ff, #e3eaff);
            color: #2f3355;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            margin: 20px 0 10px;
            font-size: 28px;
            color: #2f3355;
        }

        .subtitle {
            text-align: center;
            margin-bottom: 15px;
            font-size: 14px;
            color: #555b80;
        }

        .week-wrapper {
            padding: 0 15px 20px;
        }

        .week {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            padding-bottom: 10px;
            scroll-behavior: smooth;
        }

        .week::-webkit-scrollbar {
            height: 8px;
        }

        .week::-webkit-scrollbar-thumb {
            background: #a4b5ff;
            border-radius: 10px;
        }

        .day-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(80, 100, 140, 0.18);
            padding: 14px;
            min-width: 280px;
            max-width: 320px;
            display: flex;
            flex-direction: column;
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 8px;
        }

        .day-name {
            font-weight: bold;
            font-size: 18px;
        }

        .section-title {
            font-size: 13px;
            font-weight: bold;
            color: #4b5180;
            margin: 8px 0 4px;
        }

        .schedule {
            border-radius: 10px;
            background: #f5f6ff;
            max-height: 260px;
            overflow-y: auto;
            padding: 6px;
        }

        .hour-row {
            display: flex;
            align-items: flex-start;
            padding: 4px 4px;
            border-radius: 8px;
            margin-bottom: 2px;
        }

        .hour-label {
            width: 52px;
            font-size: 11px;
            color: #6b70a0;
            flex-shrink: 0;
        }

        .hour-content {
            flex: 1;
            min-height: 20px;
            padding: 2px 6px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            outline: none;
            border: 1px solid transparent;
        }

        .hour-content:focus {
            border-color: #a4b5ff;
            background: #ffffff;
        }

        .todo-section {
            margin-top: 10px;
            border-radius: 10px;
            background: #f5f6ff;
            padding: 8px;
        }

        .todo-input-row {
            display: flex;
            gap: 6px;
            margin-bottom: 6px;
        }

        .todo-input {
            flex: 1;
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid #c1c6f0;
            font-size: 12px;
        }

        .todo-add-btn {
            padding: 6px 10px;
            border-radius: 8px;
            border: none;
            background: #9aaeff;
            color: white;
            font-size: 12px;
            cursor: pointer;
        }

        .todo-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 130px;
            overflow-y: auto;
        }

        .todo-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 4px 4px;
            border-radius: 6px;
            margin-bottom: 3px;
            font-size: 12px;
            background: rgba(255, 255, 255, 0.9);
        }

        /* IMAGE GALLERY SECTION */
        .gallery-section {
            margin: 20px auto;
            width: 90%;
            max-width: 700px;
            background: rgba(255, 255, 255, 0.85);
            padding: 16px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(80, 100, 140, 0.18);
        }

        .gallery-title {
            font-size: 18px;
            font-weight: bold;
            color: #2f3355;
            margin-bottom: 10px;
            text-align: center;
        }

        .gallery-upload {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .gallery-upload input {
            flex: 1;
        }

        .gallery-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .gallery-item {
            background: white;
            padding: 10px;
            border-radius: 14px;
            box-shadow: 0 3px 10px rgba(120, 140, 180, 0.2);
        }

        .gallery-item img {
            width: 100%;
            border-radius: 12px;
        }

        .caption {
            margin-top: 6px;
            font-size: 13px;
            color: #4b5180;
        }

        .delete-btn {
            margin-top: 6px;
            background: #d46a6a;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
        }

        .delete-btn:hover {
            background: #b44545;
        }
    </style>
</head>
<body>

    <h1>Weekly Planner</h1>
    <p class="subtitle">Scroll horizontally to move through the week. Everything saves automatically.</p>

    <div class="week-wrapper">
        <div class="week" id="weekContainer"></div>
    </div>

    <!-- IMAGE GALLERY -->
    <div class="gallery-section">
        <div class="gallery-title">Image Gallery</div>

        <div class="gallery-upload">
            <input type="file" id="imageInput" accept="image/*">
            <input type="text" id="captionInput" placeholder="Caption...">
        </div>

        <button id="addImageBtn" class="todo-add-btn">Add Image</button>

        <div class="gallery-list" id="galleryList"></div>
    </div>

    <script>
        /* ---------------- WEEKLY PLANNER LOGIC ---------------- */

        const daysOfWeek = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
        const startHour = 8;
        const endHour = 20;
        const storageKey = "weeklyPlanner_v1";
        const galleryKey = "weeklyGallery_v1";

        function createEmptyData() {
            const data = {};
            daysOfWeek.forEach(day => {
                data[day] = { schedule: {}, todos: [] };
            });
            return data;
        }

        function loadData() {
            const saved = localStorage.getItem(storageKey);
            return saved ? JSON.parse(saved) : createEmptyData();
        }

        function saveData(data) {
            localStorage.setItem(storageKey, JSON.stringify(data));
        }

        function formatHour(h) {
            return h.toString().padStart(2, "0") + ":00";
        }

        function buildPlanner() {
            const container = document.getElementById("weekContainer");
            const data = loadData();

            daysOfWeek.forEach(day => {
                const card = document.createElement("div");
                card.className = "day-card";

                const header = document.createElement("div");
                header.className = "day-header";

                const name = document.createElement("div");
                name.className = "day-name";
                name.textContent = day;

                header.appendChild(name);
                card.appendChild(header);

                const scheduleTitle = document.createElement("div");
                scheduleTitle.className = "section-title";
                scheduleTitle.textContent = "Schedule (08:00 – 20:00)";
                card.appendChild(scheduleTitle);

                const schedule = document.createElement("div");
                schedule.className = "schedule";

                for (let h = startHour; h <= endHour; h++) {
                    const row = document.createElement("div");
                    row.className = "hour-row";

                    const label = document.createElement("div");
                    label.className = "hour-label";
                    label.textContent = formatHour(h);

                    const content = document.createElement("div");
                    content.className = "hour-content";
                    content.contentEditable = "true";

                    const hourKey = formatHour(h);
                    content.textContent = data[day].schedule[hourKey] || "";

                    content.addEventListener("input", () => {
                        const d = loadData();
                        d[day].schedule[hourKey] = content.textContent.trim();
                        saveData(d);
                    });

                    row.appendChild(label);
                    row.appendChild(content);
                    schedule.appendChild(row);
                }

                card.appendChild(schedule);

                const todoTitle = document.createElement("div");
                todoTitle.className = "section-title";
                todoTitle.textContent = "To‑Do";
                card.appendChild(todoTitle);

                const todoSection = document.createElement("div");
                todoSection.className = "todo-section";

                const inputRow = document.createElement("div");
                inputRow.className = "todo-input-row";

                const todoInput = document.createElement("input");
                todoInput.className = "todo-input";
                todoInput.placeholder = "Add a task...";

                const addBtn = document.createElement("button");
                addBtn.className = "todo-add-btn";
                addBtn.textContent = "Add";

                inputRow.appendChild(todoInput);
                inputRow.appendChild(addBtn);

                const list = document.createElement("ul");
                list.className = "todo-list";

                todoSection.appendChild(inputRow);
                todoSection.appendChild(list);
                card.appendChild(todoSection);

                function renderTodos() {
                    const d = loadData();
                    const todos = d[day].todos;
                    list.innerHTML = "";

                    todos.forEach((todo, i) => {
                        const li = document.createElement("li");
                        li.className = "todo-item";

                        const left = document.createElement("div");
                        left.className = "todo-left";

                        const checkbox = document.createElement("input");
                        checkbox.type = "checkbox";
                        checkbox.checked = todo.completed;

                        const text = document.createElement("span");
                        text.className = "todo-text";
                        text.textContent = todo.text;

                        if (todo.completed) text.style.textDecoration = "line-through";

                        checkbox.addEventListener("change", () => {
                            const d = loadData();
                            d[day].todos[i].completed = checkbox.checked;
                            saveData(d);
                            renderTodos();
                        });

                        left.appendChild(checkbox);
                        left.appendChild(text);

                        const del = document.createElement("button");
                        del.className = "todo-delete-btn";
                        del.textContent = "✕";

                        del.addEventListener("click", () => {
                            const d = loadData();
                            d[day].todos.splice(i, 1);
                            saveData(d);
                            renderTodos();
                        });

                        li.appendChild(left);
                        li.appendChild(del);
                        list.appendChild(li);
                    });
                }

                function addTodo() {
                    const text = todoInput.value.trim();
                    if (!text) return;

                    const d = loadData();
                    d[day].todos.push({ text, completed: false });
                    saveData(d);

                    todoInput.value = "";
                    renderTodos();
                }

                addBtn.addEventListener("click", addTodo);
                todoInput.addEventListener("keydown", e => {
                    if (e.key === "Enter") addTodo();
                });

                renderTodos();
                container.appendChild(card);
            });
        }

        /* ---------------- IMAGE GALLERY LOGIC ---------------- */

        function loadGallery() {
            const saved = localStorage.getItem(galleryKey);
            return saved ? JSON.parse(saved) : [];
        }

        function saveGallery(data) {
            localStorage.setItem(galleryKey, JSON.stringify(data));
        }

        function renderGallery() {
            const gallery = document.getElementById("galleryList");
            const images = loadGallery();
            gallery.innerHTML = "";

            images.forEach((item, index) => {
                const div = document.createElement("div");
                div.className = "gallery-item";

                const img = document.createElement("img");
                img.src = item.src;

                const caption = document.createElement("div");
                caption.className = "caption";
                caption.textContent = item.caption;

                const del = document.createElement("button");
                del.className = "delete-btn";
                del.textContent = "Delete";

                del.addEventListener("click", () => {
                    const data = loadGallery();
                    data.splice(index, 1);
                    saveGallery(data);
                    renderGallery();
                });

                div.appendChild(img);
                div.appendChild(caption);
                div.appendChild(del);

                gallery.appendChild(div);
            });
        }

        document.getElementById("addImageBtn").addEventListener("click", () => {
            const fileInput = document.getElementById("imageInput");
            const captionInput = document.getElementById("captionInput");

            const file = fileInput.files[0];
            const caption = captionInput.value.trim();

            if (!file) return;

            const reader = new FileReader();
            reader.onload = () => {
                const data = loadGallery();
                data.push({ src: reader.result, caption });
                saveGallery(data);
                renderGallery();
            };

            reader.readAsDataURL(file);

            fileInput.value = "";
            captionInput.value = "";
        });

        document.addEventListener("DOMContentLoaded", () => {
            buildPlanner();
            renderGallery();
        });
    </script>

</body>
</html>
