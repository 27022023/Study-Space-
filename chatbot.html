<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="icon_1772044007674.png?v=1" type="image/png">
<meta charset="UTF-8">
<title>Nova â€“ Study Companion</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root{
    --bg1:#e8d9ff;
    --bg2:#d7eaff;
    --nova-bubble:#d4c4ff;
    --user-bubble:#c9f2ff;
    --text-main:#1e1e2e;
  }
  body{
    margin:0;
    font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--text-main);
    display:flex;
    flex-direction:column;
    height:100vh;
  }
  header{
    padding:10px 16px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(0,0,0,0.05);
    display:flex;
    align-items:center;
    gap:10px;
  }
  .nova-avatar{
    width:36px;
    height:36px;
    border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #a855f7, #6366f1);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
  }
  .title{
    font-weight:700;
    font-size:16px;
  }
  .subtitle{
    font-size:12px;
    color:#4b5563;
  }
  #chat{
    flex:1;
    padding:12px;
    overflow-y:auto;
  }
  .msg{
    max-width:80%;
    margin:6px 0;
    padding:8px 12px;
    border-radius:12px;
    font-size:14px;
    line-height:1.4;
    white-space:pre-wrap;
  }
  .nova{
    background:var(--nova-bubble);
    margin-right:auto;
    border-bottom-left-radius:4px;
  }
  .user{
    background:var(--user-bubble);
    margin-left:auto;
    border-bottom-right-radius:4px;
  }
  #inputBar{
    display:flex;
    padding:8px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-top:1px solid rgba(0,0,0,0.05);
    gap:8px;
  }
  #userInput{
    flex:1;
    padding:8px;
    border-radius:8px;
    border:1px solid rgba(148,163,184,0.8);
    background:rgba(255,255,255,0.8);
    color:var(--text-main);
  }
  #sendBtn{
    padding:8px 14px;
    border-radius:8px;
    border:none;
    background:#a855f7;
    color:white;
    font-weight:600;
    cursor:pointer;
  }
  #sendBtn:hover{
    background:#8b5cf6;
  }
  .hint{
    font-size:11px;
    color:#6b7280;
    padding:0 14px 6px;
  }
</style>
</head>
<body>
<header>
  <div class="nova-avatar">ğŸ¤–</div>
  <div>
    <div class="title">Nova</div>
    <div class="subtitle">Pastel study buddy â€“ Maths â€¢ Physics â€¢ Chemistry</div>
  </div>
</header>

<div class="hint">
  Try things like: â€œ2x - 5 = 11â€, â€œexample physicsâ€, â€œexample chemistryâ€, â€œsolve 3x+2=11â€, â€œgive me a math exampleâ€.
</div>

<div id="chat"></div>

<div id="inputBar">
  <input id="userInput" type="text" placeholder="Give Nova a problem or ask for an example..." autocomplete="off">
  <button id="sendBtn">Send</button>
</div>

<script>
const chatEl = document.getElementById("chat");
const inputEl = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");

let userName = null;
let mode = "math-first"; // main focus
let lastMathProblem = null;

// --- Example banks (Maths / Physics / Chemistry) ---
const examples = {
  math: [
    {
      q:"Solve the equation: 2x - 5 = 11",
      a:"2x - 5 = 11 â‡’ 2x = 16 â‡’ x = 8."
    },
    {
      q:"Solve the system:\n2x + y = 7\nx - y = 1",
      a:"From x - y = 1 â‡’ y = x - 1.\nSubstitute: 2x + (x - 1) = 7 â‡’ 3x - 1 = 7 â‡’ 3x = 8 â‡’ x = 8/3, y = 5/3."
    },
    {
      q:"Solve the quadratic: xÂ² - 5x + 6 = 0",
      a:"xÂ² - 5x + 6 = 0 â‡’ (x - 2)(x - 3) = 0 â‡’ x = 2 or x = 3."
    },
    {
      q:"Find the derivative of f(x) = xÂ³ - 5x + 2",
      a:"f'(x) = 3xÂ² - 5."
    },
    {
      q:"Compute the integral âˆ«(3xÂ² - 4x + 1) dx",
      a:"âˆ«3xÂ² dx = xÂ³, âˆ«-4x dx = -2xÂ², âˆ«1 dx = x â‡’ xÂ³ - 2xÂ² + x + C."
    },
    {
      q:"Find the domain of f(x) = 1/(x - 3)",
      a:"All real numbers except x = 3."
    },
    {
      q:"Probability: A coin is tossed 3 times. P(exactly 2 heads)?",
      a:"Number of outcomes: 2Â³ = 8. Ways to get 2 heads: 3. So P = 3/8."
    }
  ],
  physics: [
    {
      q:"A body moves with constant velocity v = 10 m/s. Find the distance in 8 s.",
      a:"s = vÂ·t = 10Â·8 = 80 m."
    },
    {
      q:"A car accelerates from rest with a = 2 m/sÂ². Find its velocity after 6 s.",
      a:"v = vâ‚€ + aÂ·t = 0 + 2Â·6 = 12 m/s."
    },
    {
      q:"A stone is thrown upwards with vâ‚€ = 20 m/s. Approximate max height (g â‰ˆ 10 m/sÂ²).",
      a:"At top: vÂ² = vâ‚€Â² - 2gh â‡’ 0 = 400 - 20h â‡’ h = 20 m."
    },
    {
      q:"A resistor R = 10 Î© is connected to V = 5 V. Find the current.",
      a:"Ohmâ€™s law: I = V/R = 5/10 = 0.5 A."
    },
    {
      q:"A wave has frequency f = 50 Hz and wavelength Î» = 2 m. Find speed.",
      a:"v = fÂ·Î» = 50Â·2 = 100 m/s."
    },
    {
      q:"A 3 kg mass moves at 4 m/s. Find kinetic energy.",
      a:"K = Â½mvÂ² = 0.5Â·3Â·16 = 24 J."
    }
  ],
  chemistry: [
    {
      q:"How many moles are in 18 g of water (Hâ‚‚O, M = 18 g/mol)?",
      a:"n = m/M = 18/18 = 1 mol."
    },
    {
      q:"Find the molarity of a solution with 5 g NaCl (M â‰ˆ 58.5 g/mol) in 500 mL.",
      a:"n = 5/58.5 â‰ˆ 0.0855 mol. Volume = 0.5 L â‡’ M â‰ˆ 0.17 mol/L."
    },
    {
      q:"pH of 0.01 M HCl (strong acid).",
      a:"[Hâº] = 0.01 â‡’ pH = -log(0.01) = 2."
    },
    {
      q:"Identify acid/base in: NHâ‚ƒ + Hâ‚‚O â†’ NHâ‚„âº + OHâ»",
      a:"NHâ‚ƒ is a base (accepts Hâº), Hâ‚‚O acts as an acid (donates Hâº)."
    },
    {
      q:"Mass percent: 10 g solute in 200 g solution.",
      a:"% w/w = (10/200)Â·100% = 5%."
    },
    {
      q:"Balance: Hâ‚‚ + Oâ‚‚ â†’ Hâ‚‚O",
      a:"Balanced: 2Hâ‚‚ + Oâ‚‚ â†’ 2Hâ‚‚O."
    }
  ]
};

// --- UI helpers ---
function addMessage(text, from="nova"){
  const div = document.createElement("div");
  div.className = "msg " + (from === "user" ? "user" : "nova");
  div.textContent = text;
  chatEl.appendChild(div);
  chatEl.scrollTop = chatEl.scrollHeight;
}

// --- Math detection helpers ---
function looksLikeEquation(msg){
  return msg.includes("=") && /[0-9x]/i.test(msg);
}

function solveLinearEquation(eqn){
  // very simple: ax + b = c
  // normalize: remove spaces
  let s = eqn.replace(/\s+/g,"");
  const parts = s.split("=");
  if (parts.length !== 2) return null;
  const left = parts[0];
  const right = parts[1];

  // move everything to left: left - right = 0
  // we only handle form ax + b = c
  // try to extract a and b from left, c from right
  // assume left like "ax+b" or "ax-b"
  const match = left.match(/([+-]?\d*)x([+-]\d+)?/i);
  if (!match) return null;

  let aStr = match[1];
  let bStr = match[2] || "+0";

  if (aStr === "" || aStr === "+") aStr = "1";
  if (aStr === "-") aStr = "-1";

  const a = parseFloat(aStr);
  const b = parseFloat(bStr);
  const c = parseFloat(right);

  if (isNaN(a) || isNaN(b) || isNaN(c) || a === 0) return null;

  const x = (c - b)/a;
  return {a,b,c,x};
}

function looksLikeArithmetic(msg){
  return /^[0-9+\-*/().\s]+$/.test(msg);
}

function safeEval(expr){
  try{
    // very basic safe eval: only numbers and operators
    if (!/^[0-9+\-*/().\s]+$/.test(expr)) return null;
    // eslint-disable-next-line no-new-func
    const f = new Function("return ("+expr+")");
    return f();
  }catch{
    return null;
  }
}

// --- Example selection ---
function getRandomExample(subject){
  const arr = examples[subject];
  if (!arr || arr.length === 0) return null;
  return arr[Math.floor(Math.random()*arr.length)];
}

// --- Nova brain ---
function novaRespond(raw){
  const msg = raw.trim();
  const lower = msg.toLowerCase();

  if (!msg) return "Give me something to chew on â€” a problem, an equation, anything.";

  // name detection
  if (!userName && (lower.startsWith("i am ") || lower.startsWith("i'm "))){
    userName = msg.split(" ").slice(2).join(" ") || "Ï†Î¯Î»Îµ";
    return `Î§Î¬ÏÎ·ÎºÎ±, ${userName}. Iâ€™m best at solving problems in maths, physics and chemistry. Try giving me one.`;
  }
  if (!userName && lower.includes("my name is")){
    userName = msg.split(/my name is/i)[1].trim() || "Ï†Î¯Î»Îµ";
    return `Nice to meet you, ${userName}. Throw me a problem when youâ€™re ready.`;
  }

  // ask for examples
  if (lower.includes("example") || lower.includes("exercise") || lower.includes("askisi") || lower.includes("Î¬ÏƒÎºÎ·ÏƒÎ·")){
    if (lower.includes("physics") || lower.includes("fysik") || lower.includes("Ï†Ï…ÏƒÎ¹ÎºÎ®")){
      const ex = getRandomExample("physics");
      return ex ? `Physics example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I donâ€™t have a physics example ready yet.";
    }
    if (lower.includes("chem") || lower.includes("Ï‡Î·Î¼ÎµÎ¯Î±")){
      const ex = getRandomExample("chemistry");
      return ex ? `Chemistry example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I donâ€™t have a chemistry example ready yet.";
    }
    // default to math
    const ex = getRandomExample("math");
    return ex ? `Math example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I donâ€™t have a math example ready yet.";
  }

  // explicit subject requests
  if (lower.includes("math") || lower.includes("Î¼Î±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ¬")){
    const ex = getRandomExample("math");
    return ex ? `Hereâ€™s a math example:\n\nQ: ${ex.q}\nA: ${ex.a}\n\nYou can also give me your own equation to solve.` 
              : "Iâ€™m ready for math, just give me an equation.";
  }
  if (lower.includes("physics") || lower.includes("Ï†Ï…ÏƒÎ¹ÎºÎ®")){
    const ex = getRandomExample("physics");
    return ex ? `Hereâ€™s a physics example:\n\nQ: ${ex.q}\nA: ${ex.a}` 
              : "Iâ€™m ready for physics questions when you are.";
  }
  if (lower.includes("chemistry") || lower.includes("Ï‡Î·Î¼ÎµÎ¯Î±")){
    const ex = getRandomExample("chemistry");
    return ex ? `Hereâ€™s a chemistry example:\n\nQ: ${ex.q}\nA: ${ex.a}` 
              : "Iâ€™m ready for chemistry questions when you are.";
  }

  // equation solving
  if (looksLikeEquation(msg)){
    const sol = solveLinearEquation(msg);
    if (sol){
      lastMathProblem = msg;
      return `Letâ€™s solve: ${msg}\n\nWe have a = ${sol.a}, b = ${sol.b}, c = ${sol.c}.\nSo  ${sol.a}x + ${sol.b} = ${sol.c} â‡’ ${sol.a}x = ${sol.c - sol.b} â‡’ x = ${(sol.c - sol.b)}/${sol.a} = ${sol.x}.`;
    }else{
      return "That looks like an equation, but itâ€™s a bit more complex than my simple linear solver. You can still ask me for examples in maths, physics or chemistry.";
    }
  }

  // arithmetic
  if (looksLikeArithmetic(msg)){
    const val = safeEval(msg);
    if (val !== null){
      lastMathProblem = msg;
      return `${msg} = ${val}`;
    }
  }

  // if user gives a number after a problem
  if (!isNaN(parseFloat(msg)) && lastMathProblem){
    return `If that number is your answer to â€œ${lastMathProblem}â€, tell me the full equation so I can check it properly.`;
  }

  // emotional / general
  if (["sad","upset","tired","stressed","frustrated","Î±Î³Ï‡Ï‰Î¼Î­Î½Î¿Ï‚","Î±Î³Ï‡Ï‰Î¼ÎµÎ½Î¿Ï‚","ÎºÎ¿Ï…ÏÎ±ÏƒÎ¼Î­Î½Î¿Ï‚"].some(w => lower.includes(w))){
    return "Okay, pause. Youâ€™re allowed to feel like that. If you want, give me a problem and Iâ€™ll handle the thinking part for a bit.";
  }

  // chat requests
  if (lower.includes("chat") || lower.includes("talk") || lower.includes("ÏƒÏ…Î¶Î®Ï„Î·ÏƒÎ·")){
    mode = "chat";
    return "We can chat a bit, but remember: my superpower is solving problems. Whenever youâ€™re ready, just drop one in.";
  }

  // default: gently push back to problems
  if (mode === "math-first"){
    return "I love that youâ€™re talking to me. Now give me something to solve â€” maths, physics, chemistry, whatever youâ€™re working on.";
  }else{
    return "Iâ€™m listening. And whenever you want, we can jump back into problems.";
  }
}

// --- Wiring UI ---
function handleSend(){
  const text = inputEl.value.trim();
  if (!text) return;
  addMessage(text,"user");
  inputEl.value = "";
  const reply = novaRespond(text);
  setTimeout(() => addMessage(reply,"nova"), 120);
}

sendBtn.addEventListener("click", handleSend);
inputEl.addEventListener("keydown", e => {
  if (e.key === "Enter") handleSend();
});

// greeting
addMessage("Hey, Iâ€™m Nova ğŸ’œğŸ§ª.\nIâ€™m built to help with maths, physics and chemistry â€” especially of higher level.\nTry giving me an equation like â€œ2x - 5 = 11â€ or say â€œexample physicsâ€.","nova");
});
</script>
</body>
</html>
