<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nova – Study Assistant</title>

  <!-- Math.js for math solving -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>

  <style>
    /* CSS will go in the next chunk */
  </style>
</head>

<body>
<div class="nova-app">
  <header class="nova-header">
    <div class="nova-title">
      <h1>Nova</h1>
      <span>High‑energy STEM study assistant</span>
    </div>
    <div class="nova-tag">Study Sphere · STEM · Step‑by‑step</div>
  </header>

  <main class="nova-main">
    <div class="nova-chat-wrapper">
      <div id="novaChat" class="nova-chat">
        <!-- Messages will appear here -->
      </div>

      <div class="nova-footer">
        <div class="nova-input-row">
          <input id="novaInput" type="text"
                 placeholder="Ask Nova a STEM question or type a problem…">
          <button onclick="handleNovaSend()">Send</button>
        </div>
        <div class="nova-hint">
          Try things like: “solve 2x + 5 = 11”, “find v if s=20m, t=4s”, “calculate pH of 0.01M HCl”.
        </div>
      </div>
    </div>
  </main>
</div>

<script>
  /* JavaScript will go in later chunks */
</script>

</body>
</html>
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f7f4ff;
  color: #111827;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.nova-app {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

/* Header */
.nova-header {
  background: linear-gradient(135deg, #bfdbfe, #e9d5ff);
  padding: 16px 24px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.nova-title {
  display: flex;
  flex-direction: column;
}

.nova-title h1 {
  margin: 0;
  font-size: 26px;
  letter-spacing: 0.03em;
}

.nova-title span {
  font-size: 13px;
  color: #374151;
}

.nova-tag {
  padding: 6px 12px;
  border-radius: 999px;
  background: rgba(15,118,110,0.08);
  color: #0f766e;
  font-size: 12px;
  font-weight: 600;
}

/* Main layout */
.nova-main {
  flex: 1;
  display: flex;
  justify-content: center;
  padding: 16px;
}

.nova-chat-wrapper {
  width: 100%;
  max-width: 900px;
  background: #fdfaf3;
  border-radius: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border: 1px solid #e5e7eb;
  position: relative;
}

/* Notebook lines */
.nova-chat-wrapper::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image: linear-gradient(to bottom, rgba(209,213,219,0.35) 1px, transparent 1px);
  background-size: 100% 32px;
  pointer-events: none;
  opacity: 0.5;
}

.nova-chat {
  position: relative;
  padding: 16px 18px 8px;
  overflow-y: auto;
  flex: 1;
  z-index: 1;
}

/* Messages */
.nova-message {
  max-width: 80%;
  padding: 10px 12px;
  border-radius: 12px;
  margin-bottom: 10px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.12);
  position: relative;
  animation: fadeIn 0.2s ease-out;
  font-size: 14px;
  line-height: 1.4;
}

.nova-message.nova {
  background: #ede9fe;
  border: 1px solid #c4b5fd;
  align-self: flex-start;
}

.nova-message.user {
  background: #dbeafe;
  border: 1px solid #93c5fd;
  align-self: flex-end;
}

.nova-message .label {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 4px;
  color: #4b5563;
}

.nova-message.nova .label {
  color: #6d28d9;
}

.nova-message.user .label {
  color: #1d4ed8;
  text-align: right;
}

.nova-message p {
  margin: 0;
  white-space: pre-wrap;
}

/* Typing indicator */
.nova-typing {
  display: none;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
}

.typing-dots {
  display: flex;
  gap: 4px;
}

.typing-dots span {
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: #9ca3af;
  animation: bounce 1s infinite;
}

.typing-dots span:nth-child(2) {
  animation-delay: 0.15s;
}

.typing-dots span:nth-child(3) {
  animation-delay: 0.3s;
}

/* Footer */
.nova-footer {
  padding: 10px 14px 14px;
  background: #f3f4f6;
  border-top: 1px solid #e5e7eb;
  z-index: 2;
}

.nova-input-row {
  display: flex;
  gap: 8px;
}

.nova-input-row input {
  flex: 1;
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid #d1d5db;
  font-size: 14px;
  outline: none;
  background: #f9fafb;
}

.nova-input-row input:focus {
  border-color: #818cf8;
  box-shadow: 0 0 0 2px rgba(129,140,248,0.3);
  background: #ffffff;
}

.nova-input-row button {
  padding: 10px 18px;
  border-radius: 999px;
  border: none;
  background: linear-gradient(135deg, #6366f1, #ec4899);
  color: white;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(79,70,229,0.4);
  transition: transform 0.08s ease-out, box-shadow 0.08s ease-out;
  white-space: nowrap;
}

.nova-input-row button:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 14px rgba(79,70,229,0.5);
}

.nova-input-row button:active {
  transform: translateY(0);
  box-shadow: 0 3px 8px rgba(79,70,229,0.4);
}

.nova-hint {
  margin-top: 6px;
  font-size: 11px;
  color: #6b7280;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes bounce {
  0%, 80%, 100% { transform: translateY(0); opacity: 0.4; }
  40% { transform: translateY(-3px); opacity: 1; }
}

/* Mobile */
@media (max-width: 700px) {
  .nova-chat-wrapper {
    border-radius: 0;
    max-width: 100%;
    height: calc(100vh - 64px);
  }
  .nova-main {
    padding: 0;
  }
}
const chatEl = document.getElementById('novaChat');
const inputEl = document.getElementById('novaInput');

/* ------------------------------
   NOVA'S MOTIVATIONAL PERSONALITY
--------------------------------*/
const motivationalPhrases = [
  "You’re doing the hard part — showing up. That’s where progress starts.",
  "Every problem you try is a rep for your brain. You’re getting stronger.",
  "You’re not behind. You’re building momentum at your own pace.",
  "Most people never even open the book. You’re already ahead.",
  "Let’s treat this like a gym session for your mind — one set at a time.",
  "You don’t have to feel ready. You just have to start. You did.",
  "Confusion is not failure — it’s the doorway to understanding.",
  "You’re allowed to take it slow. Deep understanding beats fast guessing.",
  "Every formula you learn is another tool in your pocket.",
  "You’re building a future where you can rely on yourself. That’s huge.",
  "You’re not stuck — you’re leveling up. This is what growth feels like.",
  "Let’s crush this one step at a time. You and me.",
  "You’re smarter than you give yourself credit for.",
  "You’re not alone in this. I’m right here with you.",
  "You’re turning effort into skill. That’s the real flex.",
  "This isn’t just homework — it’s training for your future self.",
  "You’re allowed to make mistakes. That’s how we learn.",
  "You’re closer than you think. Let’s push a little further.",
  "You’re doing work that future‑you will be grateful for.",
  "You’re not just solving problems — you’re building discipline."
];

function randomMotivation() {
  return motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
}

/* ------------------------------
   MESSAGE RENDERING
--------------------------------*/
function addMessage(text, sender = 'nova') {
  const msg = document.createElement('div');
  msg.className = `nova-message ${sender}`;

  const label = document.createElement('div');
  label.className = 'label';
  label.textContent = sender === 'nova' ? 'Nova' : 'You';

  const p = document.createElement('p');
  p.textContent = text;

  msg.appendChild(label);
  msg.appendChild(p);
  chatEl.appendChild(msg);

  chatEl.scrollTop = chatEl.scrollHeight;
}

/* ------------------------------
   TYPING INDICATOR
--------------------------------*/
function novaTyping(on) {
  let typingEl = document.getElementById('novaTyping');

  if (on) {
    if (!typingEl) {
      typingEl = document.createElement('div');
      typingEl.id = 'novaTyping';
      typingEl.className = 'nova-message nova nova-typing';
      typingEl.innerHTML = `
        <div class="label">Nova</div>
        <div style="display:flex;align-items:center;gap:6px;">
          <span>Thinking</span>
          <div class="typing-dots">
            <span></span><span></span><span></span>
          </div>
        </div>
      `;
      chatEl.appendChild(typingEl);
    }
    typingEl.style.display = 'flex';
  } else if (typingEl) {
    typingEl.style.display = 'none';
  }

  chatEl.scrollTop = chatEl.scrollHeight;
}

/* ------------------------------
   SEND MESSAGE
--------------------------------*/
function handleNovaSend() {
  const text = inputEl.value.trim();
  if (!text) return;

  addMessage(text, 'user');
  inputEl.value = '';

  processNovaInput(text);
}

inputEl.addEventListener('keydown', e => {
  if (e.key === 'Enter') handleNovaSend();
});

/* ------------------------------
   ROUTING USER INPUT
--------------------------------*/
function processNovaInput(raw) {
  const text = raw.toLowerCase();

  novaTyping(true);

  setTimeout(() => {
    const response = routeNova(text, raw);
    novaTyping(false);
    addMessage(response, 'nova');
  }, 700 + Math.random() * 600);
}

function routeNova(text, raw) {
  // Greetings
  if (text.includes('hello') || text.includes('hi') || text.includes('hey')) {
    return "Hey, you showed up — that’s the hardest part. What are we studying today?";
  }

  // Motivation
  if (text.includes('motivate') || text.includes('motivation') || text.includes('tired')) {
    return randomMotivation();
  }

  // Subject routing
  if (text.includes('physics')) return randomMotivation() + "\n\nTell me a physics problem to solve.";
  if (text.includes('chemistry') || text.includes('chem')) return randomMotivation() + "\n\nAsk me a chemistry calculation.";
  if (text.includes('biology') || text.includes('bio')) return handleBiologyHelper(text);

  // Chemistry keywords
  if (text.includes('ph') || text.includes('molar') || text.includes('moles')) {
    return handleChemistry(raw);
  }

  // Physics keywords
  if (text.includes('velocity') || text.includes('speed') || text.includes('acceleration') ||
      text.includes('force') || text.includes('energy') || text.includes('power')) {
    return handlePhysics(raw);
  }

  // Math keywords
  if (text.match(/=|solve|simplify|derivative|integral|limit/)) {
    return handleMath(raw);
  }

  return randomMotivation() + "\n\nTry something like:\n• “solve 2x + 5 = 11”\n• “find v if s=20m, t=4s”\n• “calculate pH of 0.01M HCl”.";
}

/* ------------------------------
   INITIAL GREETING
--------------------------------*/
window.addEventListener('load', () => {
  addMessage(
    "Hey, I’m Nova — your high‑energy STEM study assistant.\n\n" +
    "Ask me to solve a math, physics, chemistry, or biology question, or tell me you need motivation. " +
    "We’ll build your future one problem at a time.",
    'nova'
  );

  setTimeout(() => addMessage(randomMotivation(), 'nova'), 900);
});
