<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nova ‚Äì Study Companion</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root{
    --bg1:#e8d9ff;
    --bg2:#d7eaff;
    --nova-bubble:#d4c4ff;
    --user-bubble:#c9f2ff;
    --text-main:#1e1e2e;
  }
  body{
    margin:0;
    font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--text-main);
    display:flex;
    flex-direction:column;
    height:100vh;
  }
  header{
    padding:10px 16px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(0,0,0,0.05);
    display:flex;
    align-items:center;
    gap:10px;
  }
  .nova-avatar{
    width:36px;
    height:36px;
    border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #a855f7, #6366f1);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
  }
  .title{
    font-weight:700;
    font-size:16px;
  }
  .subtitle{
    font-size:12px;
    color:#4b5563;
  }
  #chat{
    flex:1;
    padding:12px;
    overflow-y:auto;
  }
  .msg{
    max-width:80%;
    margin:6px 0;
    padding:8px 12px;
    border-radius:12px;
    font-size:14px;
    line-height:1.4;
    white-space:pre-wrap;
  }
  .nova{
    background:var(--nova-bubble);
    margin-right:auto;
    border-bottom-left-radius:4px;
  }
  .user{
    background:var(--user-bubble);
    margin-left:auto;
    border-bottom-right-radius:4px;
  }
  #inputBar{
    display:flex;
    padding:8px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-top:1px solid rgba(0,0,0,0.05);
    gap:8px;
  }
  #userInput{
    flex:1;
    padding:8px;
    border-radius:8px;
    border:1px solid rgba(148,163,184,0.8);
    background:rgba(255,255,255,0.8);
    color:var(--text-main);
  }
  #sendBtn{
    padding:8px 14px;
    border-radius:8px;
    border:none;
    background:#a855f7;
    color:white;
    font-weight:600;
    cursor:pointer;
  }
  #sendBtn:hover{
    background:#8b5cf6;
  }
  .hint{
    font-size:11px;
    color:#6b7280;
    padding:0 14px 6px;
  }
</style>
</head>
<body>

<header>
  <div class="nova-avatar">ü§ñ</div>
  <div>
    <div class="title">Nova</div>
    <div class="subtitle">Pastel study buddy ‚Äì Maths ‚Ä¢ Physics ‚Ä¢ Chemistry ‚Ä¢ Biology</div>
  </div>
</header>

<div class="hint">
  Try things like: ‚Äú2x - 5 = 11‚Äù, ‚Äúexample physics‚Äù, ‚Äúexample chemistry‚Äù, ‚Äúsolve 3x+2=11‚Äù, ‚Äúgive me a math example‚Äù.
</div>

<div id="chat"></div>

<div id="inputBar">
  <input id="userInput" type="text" placeholder="Give Nova a problem or ask for an example..." autocomplete="off">
  <button id="sendBtn">Send</button>
</div>

<script>
  <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nova ‚Äì Study Companion</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root{
    --bg1:#e8d9ff;
    --bg2:#d7eaff;
    --nova-bubble:#d4c4ff;
    --user-bubble:#c9f2ff;
    --text-main:#1e1e2e;
  }
  body{
    margin:0;
    font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--text-main);
    display:flex;
    flex-direction:column;
    height:100vh;
  }
  header{
    padding:10px 16px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(0,0,0,0.05);
    display:flex;
    align-items:center;
    gap:10px;
  }
  .nova-avatar{
    width:36px;
    height:36px;
    border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #a855f7, #6366f1);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
  }
  .title{
    font-weight:700;
    font-size:16px;
  }
  .subtitle{
    font-size:12px;
    color:#4b5563;
  }
  #chat{
    flex:1;
    padding:12px;
    overflow-y:auto;
  }
  .msg{
    max-width:80%;
    margin:6px 0;
    padding:8px 12px;
    border-radius:12px;
    font-size:14px;
    line-height:1.4;
    white-space:pre-wrap;
  }
  .nova{
    background:var(--nova-bubble);
    margin-right:auto;
    border-bottom-left-radius:4px;
  }
  .user{
    background:var(--user-bubble);
    margin-left:auto;
    border-bottom-right-radius:4px;
  }
  #inputBar{
    display:flex;
    padding:8px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(10px);
    border-top:1px solid rgba(0,0,0,0.05);
    gap:8px;
  }
  #userInput{
    flex:1;
    padding:8px;
    border-radius:8px;
    border:1px solid rgba(148,163,184,0.8);
    background:rgba(255,255,255,0.8);
    color:var(--text-main);
  }
  #sendBtn{
    padding:8px 14px;
    border-radius:8px;
    border:none;
    background:#a855f7;
    color:white;
    font-weight:600;
    cursor:pointer;
  }
  #sendBtn:hover{
    background:#8b5cf6;
  }
  .hint{
    font-size:11px;
    color:#6b7280;
    padding:0 14px 6px;
  }
</style>
</head>
<body>

<header>
  <div class="nova-avatar">ü§ñ</div>
  <div>
    <div class="title">Nova</div>
    <div class="subtitle">Pastel study buddy ‚Äì Maths ‚Ä¢ Physics ‚Ä¢ Chemistry</div>
  </div>
</header>

<div class="hint">
  Try things like: ‚Äú2x - 5 = 11‚Äù, ‚Äúexample physics‚Äù, ‚Äúexample chemistry‚Äù, ‚Äúsolve 3x+2=11‚Äù, ‚Äúgive me a math example‚Äù.
</div>

<div id="chat"></div>

<div id="inputBar">
  <input id="userInput" type="text" placeholder="Give Nova a problem or ask for an example..." autocomplete="off">
  <button id="sendBtn">Send</button>
</div>

<script>
const chatEl = document.getElementById("chat");
const inputEl = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");

let userName = null;
let mode = "math-first"; // main focus
let lastMathProblem = null;

// --- Example banks (Maths / Physics / Chemistry) ---
const examples = {
  math: [
    {
      q:"Solve the equation: 2x - 5 = 11",
      a:"2x - 5 = 11 ‚áí 2x = 16 ‚áí x = 8."
    },
    {
      q:"Solve the system:\n2x + y = 7\nx - y = 1",
      a:"From x - y = 1 ‚áí y = x - 1.\nSubstitute: 2x + (x - 1) = 7 ‚áí 3x - 1 = 7 ‚áí 3x = 8 ‚áí x = 8/3, y = 5/3."
    },
    {
      q:"Solve the quadratic: x¬≤ - 5x + 6 = 0",
      a:"x¬≤ - 5x + 6 = 0 ‚áí (x - 2)(x - 3) = 0 ‚áí x = 2 or x = 3."
    },
    {
      q:"Find the derivative of f(x) = x¬≥ - 5x + 2",
      a:"f'(x) = 3x¬≤ - 5."
    },
    {
      q:"Compute the integral ‚à´(3x¬≤ - 4x + 1) dx",
      a:"‚à´3x¬≤ dx = x¬≥, ‚à´-4x dx = -2x¬≤, ‚à´1 dx = x ‚áí x¬≥ - 2x¬≤ + x + C."
    },
    {
      q:"Find the domain of f(x) = 1/(x - 3)",
      a:"All real numbers except x = 3."
    },
    {
      q:"Probability: A coin is tossed 3 times. P(exactly 2 heads)?",
      a:"Number of outcomes: 2¬≥ = 8. Ways to get 2 heads: 3. So P = 3/8."
    }
  ],
  physics: [
    {
      q:"A body moves with constant velocity v = 10 m/s. Find the distance in 8 s.",
      a:"s = v¬∑t = 10¬∑8 = 80 m."
    },
    {
      q:"A car accelerates from rest with a = 2 m/s¬≤. Find its velocity after 6 s.",
      a:"v = v‚ÇÄ + a¬∑t = 0 + 2¬∑6 = 12 m/s."
    },
    {
      q:"A stone is thrown upwards with v‚ÇÄ = 20 m/s. Approximate max height (g ‚âà 10 m/s¬≤).",
      a:"At top: v¬≤ = v‚ÇÄ¬≤ - 2gh ‚áí 0 = 400 - 20h ‚áí h = 20 m."
    },
    {
      q:"A resistor R = 10 Œ© is connected to V = 5 V. Find the current.",
      a:"Ohm‚Äôs law: I = V/R = 5/10 = 0.5 A."
    },
    {
      q:"A wave has frequency f = 50 Hz and wavelength Œª = 2 m. Find speed.",
      a:"v = f¬∑Œª = 50¬∑2 = 100 m/s."
    },
    {
      q:"A 3 kg mass moves at 4 m/s. Find kinetic energy.",
      a:"K = ¬Ωmv¬≤ = 0.5¬∑3¬∑16 = 24 J."
    }
  ],
  chemistry: [
    {
      q:"How many moles are in 18 g of water (H‚ÇÇO, M = 18 g/mol)?",
      a:"n = m/M = 18/18 = 1 mol."
    },
    {
      q:"Find the molarity of a solution with 5 g NaCl (M ‚âà 58.5 g/mol) in 500 mL.",
      a:"n = 5/58.5 ‚âà 0.0855 mol. Volume = 0.5 L ‚áí M ‚âà 0.17 mol/L."
    },
    {
      q:"pH of 0.01 M HCl (strong acid).",
      a:"[H‚Å∫] = 0.01 ‚áí pH = -log(0.01) = 2."
    },
    {
      q:"Identify acid/base in: NH‚ÇÉ + H‚ÇÇO ‚Üí NH‚ÇÑ‚Å∫ + OH‚Åª",
      a:"NH‚ÇÉ is a base (accepts H‚Å∫), H‚ÇÇO acts as an acid (donates H‚Å∫)."
    },
    {
      q:"Mass percent: 10 g solute in 200 g solution.",
      a:"% w/w = (10/200)¬∑100% = 5%."
    },
    {
      q:"Balance: H‚ÇÇ + O‚ÇÇ ‚Üí H‚ÇÇO",
      a:"Balanced: 2H‚ÇÇ + O‚ÇÇ ‚Üí 2H‚ÇÇO."
    }
  ]
};

// --- UI helpers ---
function addMessage(text, from="nova"){
  const div = document.createElement("div");
  div.className = "msg " + (from === "user" ? "user" : "nova");
  div.textContent = text;
  chatEl.appendChild(div);
  chatEl.scrollTop = chatEl.scrollHeight;
}

// --- Math detection helpers ---
function looksLikeEquation(msg){
  return msg.includes("=") && /[0-9x]/i.test(msg);
}

function solveLinearEquation(eqn){
  // very simple: ax + b = c
  // normalize: remove spaces
  let s = eqn.replace(/\s+/g,"");
  const parts = s.split("=");
  if (parts.length !== 2) return null;
  const left = parts[0];
  const right = parts[1];

  // move everything to left: left - right = 0
  // we only handle form ax + b = c
  // try to extract a and b from left, c from right
  // assume left like "ax+b" or "ax-b"
  const match = left.match(/([+-]?\d*)x([+-]\d+)?/i);
  if (!match) return null;

  let aStr = match[1];
  let bStr = match[2] || "+0";

  if (aStr === "" || aStr === "+") aStr = "1";
  if (aStr === "-") aStr = "-1";

  const a = parseFloat(aStr);
  const b = parseFloat(bStr);
  const c = parseFloat(right);

  if (isNaN(a) || isNaN(b) || isNaN(c) || a === 0) return null;

  const x = (c - b)/a;
  return {a,b,c,x};
}

function looksLikeArithmetic(msg){
  return /^[0-9+\-*/().\s]+$/.test(msg);
}

function safeEval(expr){
  try{
    // very basic safe eval: only numbers and operators
    if (!/^[0-9+\-*/().\s]+$/.test(expr)) return null;
    // eslint-disable-next-line no-new-func
    const f = new Function("return ("+expr+")");
    return f();
  }catch{
    return null;
  }
}

// --- Example selection ---
function getRandomExample(subject){
  const arr = examples[subject];
  if (!arr || arr.length === 0) return null;
  return arr[Math.floor(Math.random()*arr.length)];
}

// --- Nova brain ---
function novaRespond(raw){
  const msg = raw.trim();
  const lower = msg.toLowerCase();

  if (!msg) return "Give me something to chew on ‚Äî a problem, an equation, anything.";

  // name detection
  if (!userName && (lower.startsWith("i am ") || lower.startsWith("i'm "))){
    userName = msg.split(" ").slice(2).join(" ") || "œÜŒØŒªŒµ";
    return `ŒßŒ¨œÅŒ∑Œ∫Œ±, ${userName}. I‚Äôm best at solving problems in maths, physics and chemistry. Try giving me one.`;
  }
  if (!userName && lower.includes("my name is")){
    userName = msg.split(/my name is/i)[1].trim() || "œÜŒØŒªŒµ";
    return `Nice to meet you, ${userName}. Throw me a problem when you‚Äôre ready.`;
  }

  // ask for examples
  if (lower.includes("example") || lower.includes("exercise") || lower.includes("askisi") || lower.includes("Œ¨œÉŒ∫Œ∑œÉŒ∑")){
    if (lower.includes("physics") || lower.includes("fysik") || lower.includes("œÜœÖœÉŒπŒ∫ŒÆ")){
      const ex = getRandomExample("physics");
      return ex ? `Physics example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I don‚Äôt have a physics example ready yet.";
    }
    if (lower.includes("chem") || lower.includes("œáŒ∑ŒºŒµŒØŒ±")){
      const ex = getRandomExample("chemistry");
      return ex ? `Chemistry example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I don‚Äôt have a chemistry example ready yet.";
    }
    // default to math
    const ex = getRandomExample("math");
    return ex ? `Math example:\n\nQ: ${ex.q}\nA: ${ex.a}` : "I don‚Äôt have a math example ready yet.";
  }

  // explicit subject requests
  if (lower.includes("math") || lower.includes("ŒºŒ±Œ∏Œ∑ŒºŒ±œÑŒπŒ∫Œ¨")){
    const ex = getRandomExample("math");
    return ex ? `Here‚Äôs a math example:\n\nQ: ${ex.q}\nA: ${ex.a}\n\nYou can also give me your own equation to solve.` 
              : "I‚Äôm ready for math, just give me an equation.";
  }
  if (lower.includes("physics") || lower.includes("œÜœÖœÉŒπŒ∫ŒÆ")){
    const ex = getRandomExample("physics");
    return ex ? `Here‚Äôs a physics example:\n\nQ: ${ex.q}\nA: ${ex.a}` 
              : "I‚Äôm ready for physics questions when you are.";
  }
  if (lower.includes("chemistry") || lower.includes("œáŒ∑ŒºŒµŒØŒ±")){
    const ex = getRandomExample("chemistry");
    return ex ? `Here‚Äôs a chemistry example:\n\nQ: ${ex.q}\nA: ${ex.a}` 
              : "I‚Äôm ready for chemistry questions when you are.";
  }

  // equation solving
  if (looksLikeEquation(msg)){
    const sol = solveLinearEquation(msg);
    if (sol){
      lastMathProblem = msg;
      return `Let‚Äôs solve: ${msg}\n\nWe have a = ${sol.a}, b = ${sol.b}, c = ${sol.c}.\nSo  ${sol.a}x + ${sol.b} = ${sol.c} ‚áí ${sol.a}x = ${sol.c - sol.b} ‚áí x = ${(sol.c - sol.b)}/${sol.a} = ${sol.x}.`;
    }else{
      return "That looks like an equation, but it‚Äôs a bit more complex than my simple linear solver. You can still ask me for examples in maths, physics or chemistry.";
    }
  }

  // arithmetic
  if (looksLikeArithmetic(msg)){
    const val = safeEval(msg);
    if (val !== null){
      lastMathProblem = msg;
      return `${msg} = ${val}`;
    }
  }

  // if user gives a number after a problem
  if (!isNaN(parseFloat(msg)) && lastMathProblem){
    return `If that number is your answer to ‚Äú${lastMathProblem}‚Äù, tell me the full equation so I can check it properly.`;
  }

  // emotional / general
  if (["sad","upset","tired","stressed","frustrated","Œ±Œ≥œáœâŒºŒ≠ŒΩŒøœÇ","Œ±Œ≥œáœâŒºŒµŒΩŒøœÇ","Œ∫ŒøœÖœÅŒ±œÉŒºŒ≠ŒΩŒøœÇ"].some(w => lower.includes(w))){
    return "Okay, pause. You‚Äôre allowed to feel like that. If you want, give me a problem and I‚Äôll handle the thinking part for a bit.";
  }

  // chat requests
  if (lower.includes("chat") || lower.includes("talk") || lower.includes("œÉœÖŒ∂ŒÆœÑŒ∑œÉŒ∑")){
    mode = "chat";
    return "We can chat a bit, but remember: my superpower is solving problems. Whenever you‚Äôre ready, just drop one in.";
  }

  // default: gently push back to problems
  if (mode === "math-first"){
    return "I love that you‚Äôre talking to me. Now give me something to solve ‚Äî maths, physics, chemistry, whatever you‚Äôre working on.";
  }else{
    return "I‚Äôm listening. And whenever you want, we can jump back into problems.";
  }
}

// --- Wiring UI ---
function handleSend(){
  const text = inputEl.value.trim();
  if (!text) return;
  addMessage(text,"user");
  inputEl.value = "";
  const reply = novaRespond(text);
  setTimeout(() => addMessage(reply,"nova"), 120);
}

sendBtn.addEventListener("click", handleSend);
inputEl.addEventListener("keydown", e => {
  if (e.key === "Enter") handleSend();
});

// greeting
addMessage("Hey, I‚Äôm Nova üíú.\nI‚Äôm built to help with maths, physics and chemistry ‚Äî especially higher levels.\nTry giving me an equation like ‚Äú2x - 5 = 11‚Äù or say ‚Äúexample physics‚Äù.","nova");
</script>

</body>
</html>
